var karacos = require('karacos'),
	assert = require('assert'),
	log4js = require('log4js')(),
	sys = require('sys');

logger = log4js.getLogger('karacos.model.Child');

/**
 * Children
 */
Child = karacos.model.Parent.extend({
	init: function(values){
		this._super(values);
	},
	map:{
		parent: 'Child:{id}:parent'
	}
}, 'Child');

Child.create = function(data, callback){
	var 
		client = karacos.wrapper.getClient();
	logger.debug("create: with data: " + sys.inspect(data));
	assert.ok((typeof data.parent !== "undefined"));
	karacos.wrapper.get(data.parent, function(err, parent) {
		if (parent.attr('id') === data.parent) {
			karacos.model.Parent.create(data, function(err,res){
				if (typeof callback !== "undefined")
					callback(err,res);
			});
		} else {
			callback("Incorrect parent id, not found",undefined);
		}
	});
}